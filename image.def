Bootstrap: docker
From: ubuntu:20.04

%environment
    export LANG=en_US.UTF-8
    export LC_ALL=en_US.UTF-8
    export DEBIAN_FRONTEND=noninteractive

%post
    apt update
    apt install -y python3-pip wget make unzip git curl

    wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2>/dev/null | gpg --dearmor - | tee /usr/share/keyrings/kitware-archive-keyring.gpg >/dev/null
    echo 'deb [signed-by=/usr/share/keyrings/kitware-archive-keyring.gpg] https://apt.kitware.com/ubuntu/ focal main' | tee /etc/apt/sources.list.d/kitware.list >/dev/null
    apt update
    rm /usr/share/keyrings/kitware-archive-keyring.gpg
    apt-get install kitware-archive-keyring
    apt install -y cmake

    pip3 install psutil robotframework==4.0.1 pyyaml west
    apt install -y locales language-pack-en && locale-gen en_US.UTF-8

%runscript
    if [ ${INSULARITY} != true ]; then
      echo "# Please use $(tput bold)$(tput setaf 3)insularity$(tput sgr0) to run this image, or set INSULARITY=true to ignore."
      exit 0
    fi
    exec "$@"
